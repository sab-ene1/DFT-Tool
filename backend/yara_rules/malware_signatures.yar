rule PotentialMalware {
    meta:
        description = "Detects potential malicious patterns"
        author = "Forensics Tool"
        date = "2023-12-04"
        
    strings:
        $cmd_shell = "cmd.exe" nocase
        $powershell = "powershell.exe" nocase
        $susp_download = "Invoke-WebRequest" nocase
        $susp_exec = "Start-Process" nocase
        $encoded_cmd = "FromBase64String" nocase
        $registry_mod = "Set-ItemProperty" nocase
        
    condition:
        2 of them
}

rule SuspiciousScripts {
    meta:
        description = "Detects suspicious script patterns"
        author = "Forensics Tool"
        date = "2023-12-04"
        
    strings:
        $vbs = ".vbs" nocase
        $bat = ".bat" nocase
        $ps1 = ".ps1" nocase
        $susp_func = "WScript.Shell" nocase
        $auto_exec = "autoexec" nocase
        
    condition:
        any of them
}

rule DataExfiltration {
    meta:
        description = "Detects potential data exfiltration patterns"
        author = "Forensics Tool"
        date = "2023-12-04"
        
    strings:
        $ftp = "ftp://" nocase
        $sftp = "sftp://" nocase
        $http_post = "POST" nocase
        $zip = "compress" nocase
        $archive = "archive" nocase
        
    condition:
        2 of them
}
